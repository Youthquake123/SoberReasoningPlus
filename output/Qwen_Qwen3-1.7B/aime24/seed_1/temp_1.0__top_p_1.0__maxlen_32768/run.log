---- 2025-08-22T08:19:14+00:00 RUN START ----
+ python /code-fsx/yibiaoy-sandbox/SoberReasoningPlus/main.py --model Qwen/Qwen3-1.7B --task 'custom|aime24|0|0' --temperature 1.0 --top_p 1.0 --output_dir /code-fsx/yibiaoy-sandbox/SoberReasoningPlus/output --max_new_tokens 32768 --max_model_length 34816 --custom_tasks_directory /code-fsx/yibiaoy-sandbox/SoberReasoningPlus/lighteval_tasks.py --system_prompt 'You are a helpful assistant.' --use_chat_template --dtype bfloat16 --max_num_seqs 128 --max_num_batched_tokens 131072 --tensor_parallel_size 4 --pipeline_parallel_size 1 --data_parallel_size 1 --seed 1
INFO 08-22 08:20:04 [__init__.py:244] Automatically detected platform cuda.
Using seed: 1
INFO 08-22 08:21:47 [__init__.py:244] Automatically detected platform cuda.
INFO 08-22 08:22:48 [__init__.py:244] Automatically detected platform cuda.
INFO 08-22 08:22:48 [__init__.py:244] Automatically detected platform cuda.
INFO 08-22 08:22:48 [__init__.py:244] Automatically detected platform cuda.
INFO 08-22 08:22:48 [__init__.py:244] Automatically detected platform cuda.
NCCL version 2.26.2+cuda12.2
[1;36m(VllmWorker rank=2 pid=1031505)[0;0m [1;36m(VllmWorker rank=0 pid=1031503)[0;0m FlashInfer version >= 0.2.3 required. Falling back to default sampling implementation.
FlashInfer version >= 0.2.3 required. Falling back to default sampling implementation.
[1;36m(VllmWorker rank=1 pid=1031504)[0;0m FlashInfer version >= 0.2.3 required. Falling back to default sampling implementation.
[1;36m(VllmWorker rank=3 pid=1031506)[0;0m FlashInfer version >= 0.2.3 required. Falling back to default sampling implementation.
[1;36m(VllmWorker rank=0 pid=1031503)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(VllmWorker rank=0 pid=1031503)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.60it/s]
[1;36m(VllmWorker rank=0 pid=1031503)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.60it/s]
[1;36m(VllmWorker rank=0 pid=1031503)[0;0m 
[1;36m(VllmWorker rank=0 pid=1031503)[0;0m Capturing CUDA graph shapes:   0%|          | 0/67 [00:00<?, ?it/s]Capturing CUDA graph shapes:   1%|▏         | 1/67 [00:00<00:30,  2.18it/s]Capturing CUDA graph shapes:   3%|▎         | 2/67 [00:00<00:27,  2.39it/s]Capturing CUDA graph shapes:   4%|▍         | 3/67 [00:01<00:26,  2.41it/s]Capturing CUDA graph shapes:   6%|▌         | 4/67 [00:01<00:25,  2.47it/s]Capturing CUDA graph shapes:   7%|▋         | 5/67 [00:02<00:24,  2.50it/s]Capturing CUDA graph shapes:   9%|▉         | 6/67 [00:02<00:24,  2.52it/s]Capturing CUDA graph shapes:  10%|█         | 7/67 [00:02<00:23,  2.53it/s]Capturing CUDA graph shapes:  12%|█▏        | 8/67 [00:03<00:23,  2.54it/s]Capturing CUDA graph shapes:  13%|█▎        | 9/67 [00:03<00:22,  2.54it/s]Capturing CUDA graph shapes:  15%|█▍        | 10/67 [00:03<00:22,  2.55it/s]Capturing CUDA graph shapes:  16%|█▋        | 11/67 [00:04<00:21,  2.55it/s]Capturing CUDA graph shapes:  18%|█▊        | 12/67 [00:04<00:21,  2.54it/s]Capturing CUDA graph shapes:  19%|█▉        | 13/67 [00:05<00:21,  2.54it/s]Capturing CUDA graph shapes:  21%|██        | 14/67 [00:05<00:20,  2.54it/s]Capturing CUDA graph shapes:  22%|██▏       | 15/67 [00:05<00:20,  2.51it/s]Capturing CUDA graph shapes:  24%|██▍       | 16/67 [00:06<00:20,  2.52it/s]Capturing CUDA graph shapes:  25%|██▌       | 17/67 [00:06<00:22,  2.23it/s]Capturing CUDA graph shapes:  27%|██▋       | 18/67 [00:07<00:23,  2.05it/s]Capturing CUDA graph shapes:  28%|██▊       | 19/67 [00:08<00:24,  1.94it/s]Capturing CUDA graph shapes:  30%|██▉       | 20/67 [00:08<00:24,  1.88it/s]Capturing CUDA graph shapes:  31%|███▏      | 21/67 [00:09<00:25,  1.84it/s]Capturing CUDA graph shapes:  33%|███▎      | 22/67 [00:09<00:24,  1.81it/s]Capturing CUDA graph shapes:  34%|███▍      | 23/67 [00:10<00:24,  1.80it/s]Capturing CUDA graph shapes:  36%|███▌      | 24/67 [00:10<00:22,  1.90it/s]Capturing CUDA graph shapes:  37%|███▋      | 25/67 [00:11<00:20,  2.05it/s]Capturing CUDA graph shapes:  39%|███▉      | 26/67 [00:11<00:18,  2.18it/s]Capturing CUDA graph shapes:  40%|████      | 27/67 [00:12<00:17,  2.24it/s]Capturing CUDA graph shapes:  42%|████▏     | 28/67 [00:12<00:16,  2.32it/s]Capturing CUDA graph shapes:  43%|████▎     | 29/67 [00:12<00:16,  2.36it/s]Capturing CUDA graph shapes:  45%|████▍     | 30/67 [00:13<00:15,  2.40it/s]Capturing CUDA graph shapes:  46%|████▋     | 31/67 [00:13<00:14,  2.44it/s]Capturing CUDA graph shapes:  48%|████▊     | 32/67 [00:14<00:14,  2.46it/s]Capturing CUDA graph shapes:  49%|████▉     | 33/67 [00:14<00:13,  2.48it/s]Capturing CUDA graph shapes:  51%|█████     | 34/67 [00:14<00:13,  2.49it/s]Capturing CUDA graph shapes:  52%|█████▏    | 35/67 [00:15<00:12,  2.50it/s]Capturing CUDA graph shapes:  54%|█████▎    | 36/67 [00:15<00:12,  2.50it/s]Capturing CUDA graph shapes:  55%|█████▌    | 37/67 [00:16<00:11,  2.51it/s]Capturing CUDA graph shapes:  57%|█████▋    | 38/67 [00:16<00:11,  2.50it/s]Capturing CUDA graph shapes:  58%|█████▊    | 39/67 [00:16<00:12,  2.23it/s]Capturing CUDA graph shapes:  60%|█████▉    | 40/67 [00:17<00:12,  2.11it/s]Capturing CUDA graph shapes:  61%|██████    | 41/67 [00:18<00:12,  2.02it/s]Capturing CUDA graph shapes:  63%|██████▎   | 42/67 [00:18<00:12,  1.97it/s]Capturing CUDA graph shapes:  64%|██████▍   | 43/67 [00:19<00:12,  1.93it/s]Capturing CUDA graph shapes:  66%|██████▌   | 44/67 [00:19<00:12,  1.90it/s]Capturing CUDA graph shapes:  67%|██████▋   | 45/67 [00:20<00:11,  1.89it/s]Capturing CUDA graph shapes:  69%|██████▊   | 46/67 [00:20<00:11,  1.86it/s]Capturing CUDA graph shapes:  70%|███████   | 47/67 [00:21<00:10,  1.93it/s]Capturing CUDA graph shapes:  72%|███████▏  | 48/67 [00:21<00:09,  2.07it/s]Capturing CUDA graph shapes:  73%|███████▎  | 49/67 [00:22<00:08,  2.18it/s]Capturing CUDA graph shapes:  75%|███████▍  | 50/67 [00:22<00:07,  2.27it/s]Capturing CUDA graph shapes:  76%|███████▌  | 51/67 [00:22<00:06,  2.33it/s]Capturing CUDA graph shapes:  78%|███████▊  | 52/67 [00:23<00:06,  2.38it/s]Capturing CUDA graph shapes:  79%|███████▉  | 53/67 [00:23<00:05,  2.41it/s]Capturing CUDA graph shapes:  81%|████████  | 54/67 [00:24<00:05,  2.44it/s]Capturing CUDA graph shapes:  82%|████████▏ | 55/67 [00:24<00:04,  2.46it/s]Capturing CUDA graph shapes:  84%|████████▎ | 56/67 [00:24<00:04,  2.47it/s]Capturing CUDA graph shapes:  85%|████████▌ | 57/67 [00:25<00:04,  2.41it/s]Capturing CUDA graph shapes:  87%|████████▋ | 58/67 [00:25<00:03,  2.43it/s]Capturing CUDA graph shapes:  88%|████████▊ | 59/67 [00:26<00:03,  2.45it/s]Capturing CUDA graph shapes:  90%|████████▉ | 60/67 [00:26<00:02,  2.46it/s]Capturing CUDA graph shapes:  91%|█████████ | 61/67 [00:27<00:02,  2.22it/s]Capturing CUDA graph shapes:  93%|█████████▎| 62/67 [00:27<00:02,  2.09it/s]Capturing CUDA graph shapes:  94%|█████████▍| 63/67 [00:28<00:02,  1.99it/s]Capturing CUDA graph shapes:  96%|█████████▌| 64/67 [00:28<00:01,  1.94it/s]Capturing CUDA graph shapes:  97%|█████████▋| 65/67 [00:29<00:01,  1.90it/s]Capturing CUDA graph shapes:  99%|█████████▊| 66/67 [00:29<00:00,  1.86it/s]Capturing CUDA graph shapes: 100%|██████████| 67/67 [00:30<00:00,  1.94it/s]Capturing CUDA graph shapes: 100%|██████████| 67/67 [00:30<00:00,  2.21it/s]
If you want to use extended_tasks, make sure you installed their dependencies using `pip install -e .[extended_tasks]`.
Careful, the task custom|aime24 is using evaluation data to build the few shot examples.
You cannot select the number of dataset splits for a generative evaluation at the moment. Automatically inferring.
Splits:   0%|          | 0/1 [00:00<?, ?it/s]
Adding requests:   0%|          | 0/30 [00:00<?, ?it/s][AAdding requests: 100%|██████████| 30/30 [00:00<00:00, 8030.96it/s]

Processed prompts:   0%|          | 0/30 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   3%|▎         | 1/30 [00:12<06:00, 12.42s/it, est. speed input: 11.19 toks/s, output: 146.53 toks/s][A
Processed prompts:   7%|▋         | 2/30 [00:18<03:59,  8.56s/it, est. speed input: 19.81 toks/s, output: 243.56 toks/s][A
Processed prompts:  10%|█         | 3/30 [00:25<03:30,  7.80s/it, est. speed input: 20.10 toks/s, output: 316.77 toks/s][A
Processed prompts:  13%|█▎        | 4/30 [00:32<03:21,  7.74s/it, est. speed input: 19.59 toks/s, output: 378.77 toks/s][A
Processed prompts:  17%|█▋        | 5/30 [00:33<02:07,  5.11s/it, est. speed input: 25.77 toks/s, output: 509.47 toks/s][A
Processed prompts:  20%|██        | 6/30 [00:36<01:45,  4.39s/it, est. speed input: 28.82 toks/s, output: 601.90 toks/s][A
Processed prompts:  23%|██▎       | 7/30 [00:47<02:29,  6.51s/it, est. speed input: 25.37 toks/s, output: 594.43 toks/s][A
Processed prompts:  27%|██▋       | 8/30 [00:48<01:46,  4.84s/it, est. speed input: 27.91 toks/s, output: 709.91 toks/s][A
Processed prompts:  30%|███       | 9/30 [00:55<01:59,  5.68s/it, est. speed input: 27.30 toks/s, output: 743.06 toks/s][A
Processed prompts:  33%|███▎      | 10/30 [01:05<02:15,  6.78s/it, est. speed input: 26.11 toks/s, output: 764.41 toks/s][A
Processed prompts:  37%|███▋      | 11/30 [01:06<01:39,  5.24s/it, est. speed input: 29.72 toks/s, output: 870.68 toks/s][A
Processed prompts:  40%|████      | 12/30 [01:11<01:29,  4.96s/it, est. speed input: 31.13 toks/s, output: 943.33 toks/s][A
Processed prompts:  43%|████▎     | 13/30 [01:14<01:16,  4.51s/it, est. speed input: 31.69 toks/s, output: 1024.20 toks/s][A
Processed prompts:  47%|████▋     | 14/30 [01:16<00:57,  3.62s/it, est. speed input: 34.09 toks/s, output: 1127.81 toks/s][A
Processed prompts:  50%|█████     | 15/30 [01:47<02:58, 11.92s/it, est. speed input: 25.76 toks/s, output: 919.78 toks/s] [A
Processed prompts:  53%|█████▎    | 16/30 [01:52<02:17,  9.85s/it, est. speed input: 26.30 toks/s, output: 996.84 toks/s][A
Processed prompts:  57%|█████▋    | 17/30 [01:55<01:40,  7.76s/it, est. speed input: 27.39 toks/s, output: 1089.71 toks/s][A
Processed prompts:  60%|██████    | 18/30 [01:57<01:13,  6.16s/it, est. speed input: 28.38 toks/s, output: 1184.55 toks/s][A
Processed prompts:  63%|██████▎   | 19/30 [01:59<00:53,  4.82s/it, est. speed input: 29.24 toks/s, output: 1285.12 toks/s][A
Processed prompts:  67%|██████▋   | 20/30 [02:13<01:15,  7.50s/it, est. speed input: 27.51 toks/s, output: 1269.21 toks/s][A
Processed prompts:  70%|███████   | 21/30 [02:20<01:06,  7.39s/it, est. speed input: 28.03 toks/s, output: 1321.27 toks/s][A
Processed prompts:  73%|███████▎  | 22/30 [02:28<01:00,  7.54s/it, est. speed input: 27.62 toks/s, output: 1366.98 toks/s][A
Processed prompts:  80%|████████  | 24/30 [02:44<00:46,  7.78s/it, est. speed input: 27.23 toks/s, output: 1454.69 toks/s][A
Processed prompts:  83%|████████▎ | 25/30 [02:56<00:44,  8.82s/it, est. speed input: 26.33 toks/s, output: 1473.38 toks/s][A
Processed prompts:  87%|████████▋ | 26/30 [03:15<00:46, 11.63s/it, est. speed input: 24.55 toks/s, output: 1444.74 toks/s][A
Processed prompts:  90%|█████████ | 27/30 [03:19<00:27,  9.31s/it, est. speed input: 24.88 toks/s, output: 1541.14 toks/s][A
Processed prompts:  93%|█████████▎| 28/30 [03:31<00:20, 10.17s/it, est. speed input: 25.71 toks/s, output: 1571.62 toks/s][A
Processed prompts:  97%|█████████▋| 29/30 [03:38<00:09,  9.31s/it, est. speed input: 25.97 toks/s, output: 1642.18 toks/s][A
Processed prompts: 100%|██████████| 30/30 [03:46<00:00,  8.91s/it, est. speed input: 26.10 toks/s, output: 1708.73 toks/s][A
Processed prompts: 100%|██████████| 30/30 [03:46<00:00,  8.91s/it, est. speed input: 26.10 toks/s, output: 1708.73 toks/s][AProcessed prompts: 100%|██████████| 30/30 [03:46<00:00,  7.55s/it, est. speed input: 26.10 toks/s, output: 1708.73 toks/s]
Splits: 100%|██████████| 1/1 [03:46<00:00, 226.71s/it]Splits: 100%|██████████| 1/1 [03:46<00:00, 226.71s/it]
|     Task      |Version|     Metric     |Value |   |Stderr|
|---------------|------:|----------------|-----:|---|-----:|
|all            |       |extractive_match|0.4667|±  |0.0926|
|custom:aime24:0|      1|extractive_match|0.4667|±  |0.0926|

Creating parquet from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating parquet from Arrow format: 100%|██████████| 1/1 [00:00<00:00, 51.82ba/s]
+ set +x
---- 2025-08-22T08:28:05+00:00 RUN END ----
---- 2025-08-22T08:41:36+00:00 RUN START ----
+ python /code-fsx/yibiaoy-sandbox/SoberReasoningPlus/main.py --model Qwen/Qwen3-1.7B --task 'custom|aime24|0|0' --temperature 1.0 --top_p 1.0 --output_dir /code-fsx/yibiaoy-sandbox/SoberReasoningPlus/output --max_new_tokens 32768 --max_model_length 34816 --custom_tasks_directory /code-fsx/yibiaoy-sandbox/SoberReasoningPlus/lighteval_tasks.py --system_prompt 'You are a helpful assistant.' --use_chat_template --dtype float32 --max_num_seqs 128 --max_num_batched_tokens 131072 --tensor_parallel_size 4 --pipeline_parallel_size 1 --data_parallel_size 1 --seed 1
INFO 08-22 08:42:25 [__init__.py:244] Automatically detected platform cuda.
Using seed: 1
